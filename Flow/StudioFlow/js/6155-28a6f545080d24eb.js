"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6155],{3419:function(e,n,t){t.d(n,{OO:function(){return f},Vg:function(){return c},_2:function(){return u}});var r=t(47568),a=t(97582),s=t(23132),i=new s.r("/api/analytics/ingestion"),l=new s.r("/api/analytics/store");function u(e){return o.apply(this,arguments)}function o(){return(o=(0,r.Z)((function(e){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,i.defaultPost("home",e)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function c(e){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)((function(e){return(0,a.__generator)(this,(function(n){switch(n.label){case 0:return[4,i.defaultPost("articles",e)];case 1:return[2,n.sent()]}}))}))).apply(this,arguments)}function f(e,n){return h.apply(this,arguments)}function h(){return(h=(0,r.Z)((function(e,n){return(0,a.__generator)(this,(function(t){switch(t.label){case 0:return[4,l.defaultAuthenticatedPost("journey",e,n)];case 1:return[2,t.sent()]}}))}))).apply(this,arguments)}},56155:function(e,n,t){t.d(n,{mT:function(){return L},Ek:function(){return J},WV:function(){return O}});var r=t(47568),a=t(82670),s=t(26042),i=t(69396),l=t(99534),u=t(828),o=t(97582),c=t(85893),d=t(67294),f=t(89583),h=t(71048),m=t(38719),p=t(60851),v=t(65033),g=t(57779),x=t(99614),b=t(57935),j=t(99490),_=t(28256),w=t(50496),y=t(86601),C=t(58678),Z=t(3419),S=t(23132),N=new S.r("https://servicodados.ibge.gov.br/api").defaultGet,k=function(e){return N("/v1/localidades/estados/".concat(e,"/municipios"))},E=new S.r("https://brasilapi.com.br/api"),P=function(e){return E.defaultGet("cep/v1/".concat(e))},A=t(50101),F=t(83122),q=t(87904),z=t(32332),I=t(82067),R=t(39167),U=t(66979),B=t(8486),M=t(17910),D=t(4480),G=t(74231);function T(e){var n=e.onClick;return(0,c.jsx)("div",{onClick:function(){return n()},className:"flex justify-start items-start p-3 h-full bg-ui-dark rounded hover:cursor-pointer skeletable round min-h-[9.5rem]",children:(0,c.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:[(0,c.jsx)(f.wEH,{size:19}),(0,c.jsx)("p",{className:"text-14 leading-5 text-ui-lightest",children:"Adicionar endere\xe7o"})]})})}function X(e){var n=e.address,t=e.editFunction,r=n.city,a=n.street,s=n.street_number,i=n.zipcode,l=n.complement,u=n.neighborhood;return(0,c.jsxs)("div",{className:"flex relative flex-col gap-3 items-start text-12 leading-3",children:[a&&(0,c.jsxs)("p",{style:{lineBreak:"anywhere"},className:"leading-4 line-clamp-1 w-[80%]",children:["Rua: ",a.replace(/Rua /i,""),s?", ".concat(s):"."]}),u&&(0,c.jsxs)("p",{style:{lineBreak:"anywhere"},className:"leading-4 line-clamp-1",children:["Bairro: ",u]}),r&&(0,c.jsxs)("p",{style:{lineBreak:"anywhere"},className:"leading-4 line-clamp-1",children:["Cidade: ",r]}),i&&(0,c.jsxs)("p",{style:{lineBreak:"anywhere"},className:"leading-4 line-clamp-1",children:["CEP: ",i]}),l&&(0,c.jsxs)("p",{style:{lineBreak:"anywhere"},className:"leading-4 line-clamp-1",children:["Complemento: ",l]}),t&&(0,c.jsx)(v.zY,{Icon:f.fmQ,color:"none",size:"large",iconSize:20,className:"top-0 right-0",position:"absolute",onClick:function(){return t()}})]})}function H(e){var n=e.handleManageAddress,t=e.handleSelectAddress,a=e.initialAddressDocId,s=e.authUser,i=e.fromPlan,l=e.GlobalChangeState,f=(0,d.useState)([]),h=f[0],m=f[1],p=(0,d.useState)(!0),v=p[0],x=p[1],b=(0,d.useState)(0),j=b[1],_=(0,u.Z)(l,2),w=_[0],C=_[1],Z=(0,d.useCallback)((function(e,n){if(h){var r=h.findIndex((function(n){return n.doc_id===e}));-1!==r&&(t(e),j((function(e){return i&&e!==r&&!n&&C(!0),r})))}}),[h,i,t,j,C]),S=(0,d.useCallback)((0,r.Z)((function(){var e,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=[s.email],[4,s.getIdToken()];case 1:return[4,A.cc.apply(void 0,t.concat(r.sent()))];case 2:return 0===(e=r.sent()).addresses.length?[2,n()]:(m(e.addresses),x(!1),[3,4]);case 3:return r.sent(),m((function(e){return null!==e&&void 0!==e?e:null})),x(!1),[3,4];case 4:return[2]}}))})),[s,n]);return(0,y.n)((function(){0===h.length&&S()}),[h,S]),(0,y.n)((function(){Z(a,!0)}),[a,Z,h]),(0,c.jsxs)("div",{className:"flex flex-col gap-2 w-full ".concat(v?"skeleton":""),children:[(0,c.jsx)("p",{className:"text-14 font-bold text-ui-white w-fit skeletable round",children:"Seus endere\xe7os:"}),(0,c.jsx)(g.BX,{state:b,children:function(e){var t=e.selectedIndex;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 auto-rows-fr gap-4 w-full",children:[(0,c.jsx)(T,{onClick:function(){C(!0),n()}}),h&&h.map((function(e,t){return(0,c.jsx)(X,{address:e,editFunction:function(){return n(e)}},"address-".concat(t))})).map((function(e,n){return(0,c.jsxs)("div",{onClick:function(){Z(e.props.address.doc_id,!1)},className:"flex gap-3 items-start p-3 w-full h-full text-ui-white bg-ui-darker rounded cursor-pointer min-h-[9.5rem]",children:[(0,c.jsx)("div",{className:"flex justify-center items-start h-full",children:(0,c.jsx)("div",{className:"flex justify-center items-center w-6 rounded-full border-2 border-ui-white select-none aspect-square",children:(0,c.jsx)("div",{className:"".concat(t===n?"bg-ui-white":"bg-ui-darker"," select-none rounded-full w-3 h-3")})})}),(0,c.jsx)("div",{className:"overflow-hidden w-full",children:e})]},"address-button-wrapper-".concat(n))}))]}),w&&i&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("p",{className:"text-12 font-bold leading-5 text-alert-light uppercase md:w-[90%]",children:"Ao selecionar outro endere\xe7o voc\xea estar\xe1 alterando seu endere\xe7o principal para todos os planos."}),(0,c.jsx)("div",{className:"mt-5 w-full"})]})]})}})]})}var V={noLayoutShift:!0,hideErrorMargin:!0,full:!0};function L(e){var n=e.initialAddress,t=void 0===n?null:n,a=e.formRef,l=(0,d.useState)(!1),u=l[0],f=l[1],h=(0,d.useState)([]),m=h[0],g=h[1],_=(0,d.useState)([]),y=_[0],C=_[1],Z=(0,d.useState)(""),S=Z[0],E=Z[1],A=(0,d.useState)(""),F=A[0],R=A[1],U=(0,d.useState)(""),D=U[0],G=U[1],T=(0,d.useState)(""),X=T[0],H=T[1],L=(0,d.useState)(""),O=L[0],W=L[1],K=(0,d.useState)(""),J=K[0],Q=K[1],Y=(0,d.useState)(""),$=Y[0],ee=Y[1],ne=(0,d.useState)(""),te=ne[0],re=ne[1],ae=(0,d.useState)(""),se=ae[0],ie=ae[1],le=(0,d.useState)(!1),ue=le[0],oe=le[1],ce=(0,w.N)(F,800),de=(0,d.useMemo)((function(){return"Brasil"===S}),[S]),fe=(0,d.useMemo)((function(){return(0,z.xP)(q.nu,"nome_pais")}),[]),he=(0,d.useCallback)(function(){var e=(0,r.Z)((function(e){var n,t,r,s,i,l;return(0,o.__generator)(this,(function(u){switch(u.label){case 0:if(!e)return[2];f(!0),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,P(e)];case 2:return n=u.sent(),t=n.street,r=n.cep,s=n.city,i=n.state,l=n.neighborhood,t&&H(t),r&&ee((0,M.Gs)(r)),s&&G(s),i&&R(i),l&&Q(l),[3,4];case 3:return u.sent(),a.current.setFieldError("zipcode",B.Ex.address.zipcodeNotFound),[3,4];case 4:return f(!1),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[a]),me=(0,d.useCallback)((0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:if(!de)return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,N("/v1/localidades/estados")];case 2:return e=t.sent(),n=e.map((function(e){return e.sigla})),g(n),[3,4];case 3:return t.sent(),a.current.setFieldError("state","N\xe3o foi poss\xedvel carregar os estados, tente novamente mais tarde"),[3,4];case 4:return[2]}}))})),[a,de]),pe=(0,d.useCallback)(function(){var e=(0,r.Z)((function(e){var n,t;return(0,o.__generator)(this,(function(r){switch(r.label){case 0:if(!de)return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,k(e)];case 2:return n=r.sent(),t=n.map((function(e){return e.nome})),C(t),[3,4];case 3:return r.sent(),[3,4];case 4:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[de]);return(0,d.useEffect)((function(){!function(e){if(e){var n,t=e.doc_id,r=e.main,a=e.zipcode,s=e.city,i=e.country,l=e.neighborhood,u=e.state,o=e.street,c=e.street_number,d=e.complement;E(i?(0,I.K)(i).nome_pais:""),R(null!==u&&void 0!==u?u:""),G(null!==s&&void 0!==s?s:""),H(null!==o&&void 0!==o?o:""),W(null!==(n=String(c))&&void 0!==n?n:""),Q(null!==l&&void 0!==l?l:""),ee(null!==a&&void 0!==a?a:""),re(null!==d&&void 0!==d?d:""),ie(null!==t&&void 0!==t?t:""),oe(null!==r&&void 0!==r&&r)}}(t)}),[t]),(0,d.useEffect)((function(){de?me():(g([]),C([]))}),[de,me]),(0,d.useEffect)((function(){ce&&pe(ce)}),[ce,pe]),(0,c.jsxs)("div",{className:"flex flex-col gap-4 w-full",children:[(0,c.jsx)(x.Z,{name:"main",value:ue?"true":"false"}),(0,c.jsx)(x.Z,{name:"doc_id",value:se}),(0,c.jsx)("p",{className:"text-14 font-bold text-ui-white",children:"Seu pa\xeds"}),(0,c.jsx)(b.rd,{maxDrawerHeight:368,onChange:function(e){E(e.target.value)},value:S,options:fe,label:"Selecione um pa\xeds",name:"country"}),(0,c.jsx)("p",{className:"text-14 font-bold text-ui-white",children:"Seu endere\xe7o:"}),(0,c.jsxs)("div",{className:"flex flex-col gap-4",children:[de?(0,c.jsxs)("div",{className:"flex gap-3 justify-center items-start w-full min-h-[2.5rem]",children:[(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{label:"CEP",name:"zipcode",value:$,onChange:function(e){return ee((0,M.Gs)(e.target.value))},onKeyDown:function(e){return"Enter"===e.key&&he($)},maxLength:11})),(0,c.jsx)("div",{className:"w-28 h-10",children:(0,c.jsx)(v.X4,{onClick:function(){return he($)},className:"px-4 w-28 h-10 bg-ui-darker rounded cursor-pointer",disabled:{status:!!u&&"disabled-light"},children:u?(0,c.jsx)(p.tx,{color:"ui-white"}):(0,c.jsx)("p",{className:"whitespace-nowrap cursor-pointer",children:"Buscar CEP"})})})]}):(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{label:"CEP/ZIP Code",value:$,onChange:function(e){return ee(e.target.value)},name:"zipcode"})),(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{value:X,maxLength:35,onChange:function(e){return H(e.target.value)},label:"Rua",name:"street"})),(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{value:O,onChange:function(e){return W(e.target.value)},label:"N\xfamero",name:"street_number"})),(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{value:J,onChange:function(e){return Q(e.target.value)},label:"Bairro",name:"neighborhood"})),de?(0,c.jsx)(b.rd,{maxDrawerHeight:200,options:null!==m&&void 0!==m?m:void 0,label:"Estado",name:"state",onChange:function(e){R(e.target.value.replace(/[^A-Za-z\xe1\xe0\xe2\xe3\xe9\xe8\xea\xed\xef\xf3\xf4\xf5\xf6\xfa\xe7\xf1\xc1\xc0\xc2\xc3\xc9\xc8\xcd\xcf\xd3\xd4\xd5\xd6\xda\xc7\xd1 -]/gi,""))},value:F}):(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{onChange:function(e){R(e.target.value)},value:F,label:"Estado",name:"state"})),de?(0,c.jsx)(b.rd,{maxDrawerHeight:200,onChange:function(e){G(e.target.value)},value:D,options:null!==y&&void 0!==y?y:void 0,label:"Cidade",name:"city"}):(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{onChange:function(e){G(e.target.value)},value:D,label:"Cidade",name:"city"})),(0,c.jsx)(j.UR,(0,i.Z)((0,s.Z)({},V),{maxLength:15,onChange:function(e){re(e.target.value)},value:te,label:"Complemento (opcional)",name:"complement"}))]})]})}var O=G.Ry().shape({zipcode:G.Z_().nullable().required(B.Ex.requiredField),street:G.Z_().nullable().required(B.Ex.requiredField),street_number:G.Z_().nullable().required(B.Ex.requiredField),neighborhood:G.Z_().nullable().required(B.Ex.requiredField),state:G.Z_().nullable().required(B.Ex.requiredField),country:G.Z_().nullable().required(B.Ex.requiredField),city:G.Z_().nullable().required(B.Ex.requiredField),complement:G.Z_().nullable(),main:G.Z_().nullable().required(B.Ex.requiredField),doc_id:G.Z_().nullable()});function W(e){var n=e.initialAddress,t=void 0===n?null:n,u=e.returnFunction,f=e.user,h=e.authUser,m=e.GlobalChangeState,g=(0,d.useRef)(),x=(0,d.useState)(!1),b=x[0],j=x[1],w=(0,_.T)().handleToast,y=(0,d.useCallback)(function(){var e=(0,r.Z)((function(e){var n,t,r,c,d,m,p,v,x,b,_,y,C,Z,S,N,k,E,P;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:j(!0),o.label=1;case 1:return o.trys.push([1,7,,8]),[4,O.validate(e,{abortEarly:!1})];case 2:return n=o.sent(),t=n.doc_id,r=n.country,c=(0,l.Z)(n,["doc_id","country"]),(null===h||void 0===h?void 0:h.email)&&(null===f||void 0===f?void 0:f.unique_id)?(d=q.nu.find((function(e){return e.nome_pais===r})))?(m=(0,i.Z)((0,s.Z)({},c),{country:d.sigla,main:"true"===c.main,email:h.email}),[4,h.getIdToken()]):(j(!1),[2,g.current.setFieldError("country","Pais inv\xe1lido")]):(w("Erro desconhecido ao salvar endere\xe7o. Atualize a p\xe1gina e tente novamente!","error"),[2]);case 3:return p=o.sent(),t?[4,(0,A.$X)((0,i.Z)((0,s.Z)({},m),{doc_id:t,email:h.email}),p)]:[3,5];case 4:return o.sent(),[2,u(t)];case 5:return[4,(0,A.gn)((0,s.Z)({},m),p)];case 6:return v=o.sent(),[2,u(v.doc_id)];case 7:return x=o.sent(),(0,a.Z)(x,G.p8)?x.inner.forEach((function(e){g.current.setFieldError(e.path,e.message)})):(null===(b=x.response)||void 0===b||null===(_=b.data)||void 0===_||null===(y=_.status)||void 0===y?void 0:y.field)?null===(C=x.response)||void 0===C||null===(Z=C.data)||void 0===Z||null===(S=Z.status)||void 0===S||S.field.map((function(e,n){g.current.setFieldError(e,x.response.data.status.message[n])})):w(null!==(P=null===(N=x.response)||void 0===N||null===(k=N.data)||void 0===k||null===(E=k.status)||void 0===E?void 0:E.message)&&void 0!==P?P:"Erro desconhecido ao salvar endere\xe7o. Atualize a p\xe1gina e tente novamente.","error"),[3,8];case 8:return j(!1),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),[h,w,u,f]);return(0,c.jsxs)(F.l,{placeholder:void 0,ref:g,onSubmit:y,className:"w-full select-none",children:[(0,c.jsx)(L,{formRef:g,initialAddress:t}),(0,c.jsxs)("div",{className:"flex gap-1 pt-6",children:[(0,c.jsx)(v.X4,{onClick:function(){m[1](!1),u()},color:"base",children:"Cancelar"}),(0,c.jsx)("div",{className:"min-w-[7.5rem]",children:(0,c.jsx)(v.X4,{fluidWidth:"100%",color:"confirmation",disabled:{status:b},onClick:function(){return g.current.submitForm()},children:b?(0,c.jsx)(p.tx,{size:16,color:"white"}):"Salvar"})})]})]})}function K(e){var n=e.changingMainAddress,t=e.fromPlan,r=e.handleCancel,a=e.handleNextPage,s=e.disableNextPageButton,i=e.isFirstPage;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(v.X4,{color:"dark",onClick:r,disabled:{status:!!n&&"disabled-light"},children:i?"Cancelar":"Voltar"}),(0,c.jsx)(v.X4,{fluidWidth:t?"4.975rem":"7.5rem",color:t?"confirmation":"primary",onClick:a,disabled:{status:!(!s&&!n)&&"disabled-light"},children:n?(0,c.jsx)(p.tx,{size:14,color:"white"}):t?"Salvar":"Avan\xe7ar"})]})}function J(e){var n,t=e.NV99MultiModalPage,a=e.context,l=e.NV99ProgressHeader,f=e.closeMultiModal,p=e.nextPage,v=e.updateContext,g=e.pastPage,x=e.previousPage,b=e.isFirstPage,j=(0,d.useState)(),_=j[0],w=j[1],S=(0,d.useState)(),N=S[0],k=S[1],E=(0,d.useMemo)((function(){return a}),[a]),P=E.heading,F=E.cart,q=E.getAuthUser,z=E.hasUniqueCard,I=(0,d.useState)(!1),B=I[0],M=I[1],G=(0,d.useState)(null),T=G[0],X=G[1],V=(0,d.useState)(),L=V[0],O=V[1],J=(0,d.useState)(!1),Q=J[0],Y=J[1],$=(0,d.useState)(!1),ee=(0,C.EC)().updateUserSession,ne=(0,d.useState)(!1),te=ne[0],re=ne[1],ae=(0,d.useCallback)((function(){v({cart:(0,i.Z)((0,s.Z)({},F),{selectedAddressId:L})}),a.fromPlan?g():p()}),[F,a,p,g,L,v]),se=(0,d.useCallback)((0,r.Z)((function(){var e,n;return(0,o.__generator)(this,(function(t){switch(t.label){case 0:return[4,q()];case 1:return e=t.sent(),re(!0),n=[{doc_id:L,email:e.email}],[4,e.getIdToken()];case 2:return[4,A.ql.apply(void 0,n.concat(t.sent()))];case 3:return t.sent(),ae(),[2]}}))})),[q,ae,L]);(0,d.useEffect)((function(){ee().then((function(e){w(e)}))}),[ee]),(0,d.useEffect)((function(){var e,n;_&&O(null!==(n=null===a||void 0===a||null===(e=a.cart)||void 0===e?void 0:e.selectedAddressId)&&void 0!==n?n:_.address_id)}),[null===a||void 0===a||null===(n=a.cart)||void 0===n?void 0:n.selectedAddressId,_]),(0,d.useEffect)((function(){q().then(k)}),[q]);var ie=(0,D._8)((function(e){var n=e.snapshot;return(0,r.Z)((function(){var e,t,r;return(0,o.__generator)(this,(function(s){switch(s.label){case 0:return[4,Promise.all([n.getPromise(h.o),n.getPromise(m.s)])];case 1:return e=u.Z.apply(void 0,[s.sent(),2]),t=e[0],r=e[1],U.I.currentUser.getIdToken().then((function(e){(0,Z.OO)({created_at:(0,R.JK)(),color_changes:t.color_changes,size_changes:t.size_changes,current_sparks:r.balance,page:"ADDRESS",payment_method:null,product:null===a||void 0===a?void 0:a.selectedStoreProduct,purchased:!1,email:U.I.currentUser.email},e)})),[2]}}))}))}),[]);return(0,y.n)((function(){z&&(Q||(Y(!0),ie()))}),[a,z,ie,Q]),(0,c.jsxs)(t,{heading:P,maxWidthInRem:35.438,footerContent:(0,c.jsx)(K,{isFirstPage:b,changingMainAddress:te,fromPlan:a.fromPlan,disableNextPageButton:!L||B,handleCancel:b?f:x,handleNextPage:a.fromPlan?se:ae}),children:[!a.fromPlan&&(0,c.jsx)(l,{onPageSelected:function(){return L&&v({cart:(0,i.Z)((0,s.Z)({},F),{selectedAddressId:L})})}}),(0,c.jsx)("div",{className:"md:w-[32.938rem] md:h-[43.375rem]",children:B?(0,c.jsx)(W,{GlobalChangeState:$,user:_,authUser:N,returnFunction:function(e){M(!1),e&&O(e)},initialAddress:T}):(0,c.jsx)(H,{GlobalChangeState:$,fromPlan:a.fromPlan,authUser:N,initialAddressDocId:L,handleSelectAddress:function(e){O(e)},handleManageAddress:function(e){M(!0),X(e||null)}})})]})}},71048:function(e,n,t){t.d(n,{o:function(){return r}});var r=(0,t(4480).cn)({key:"journeyAtom",default:{color_changes:0,size_changes:0}})}}]);